<link rel="stylesheet" href="{{ static('css/matching.css') }}">

<form id="assignmentMovedForm"
      hx-patch="/matching/move/"
      hx-ext="json-enc"
      hx-headers='{"X-CSRFToken": "{{ get_csrf_token(request) }}"}'
      hx-target="#errorContainer"
      hx-trigger="assignmentmoved"
      hx-swap="outerHTML"
      hx-target="#kanban-board"
      class="">
    <input type="hidden" name="assignmentId" value="">
    <input type="hidden" name="statusId" value="">
</form>
<div id="errorContainer"></div>

<div class="wies-kanban-board" id="kanban-board">
    <!-- LEAD opdrachten -->
    <div class="wies-kanban-column" data-column="LEAD">
        <div class="wies-kanban-column-header">
            <div class="wies-kanban-column-title">
                <span class="utrecht-icon rvo-icon rvo-icon-pijl-naar-rechts rvo-icon--lg" role="img" aria-label="lead-icon"></span>
                <span>Lead</span>
            </div>
            <span class="rvo-badge">{{ assignments_by_status.LEAD|length }}</span>
        </div>
        <div class="wies-kanban-cards" id="lead-cards">
            {% for assignment in assignments_by_status.LEAD %}
            <div class="wies-kanban-card" draggable="true" data-type="assignment" data-id="{{ assignment.id }}" onclick="openAssignment({{ assignment.id }})">
                <c-card title="{{ assignment.name }}">
                    <div class="wies-card-subtitle">{{ assignment.ministry.name }}</div>
                    <div class="wies-card-meta">
                        {% if assignment.owner %}Eigenaar: {{ assignment.owner.name }}<br>{% endif %}
                        {% if assignment.start_date %}{{ assignment.start_date.strftime('%d %b %Y') }}{% endif %}
                        {% if assignment.end_date %} - {{ assignment.end_date.strftime('%d %b %Y') }}{% endif %}
                    </div>
                </c-card>
            </div>
            {% else %}
            <div class="rvo-text rvo-text--subtle">Geen lead opdrachten</div>
            {% endfor %}
        </div>
    </div>

    <!-- VACATURE opdrachten -->
    <div class="wies-kanban-column" data-column="VACATURE">
        <div class="wies-kanban-column-header">
            <div class="wies-kanban-column-title">
                <span class="utrecht-icon rvo-icon rvo-icon-refresh rvo-icon--lg" role="img" aria-label="vacature-icon"></span>
                <span>Vacature</span>
            </div>
            <span class="rvo-badge">{{ assignments_by_status.VACATURE|length }}</span>
        </div>
        <div class="wies-kanban-cards" id="vacature-cards">
            {% for assignment in assignments_by_status.VACATURE %}
            <div class="wies-kanban-card" draggable="true" data-type="assignment" data-id="{{ assignment.id }}" onclick="openAssignment({{ assignment.id }})">
                <c-card title="{{ assignment.name }}">
                    <div class="wies-card-subtitle">{{ assignment.ministry.name }}</div>
                    <div class="wies-card-meta">
                        {% if assignment.owner %}Eigenaar: {{ assignment.owner.name }}<br>{% endif %}
                        {% if assignment.start_date %}{{ assignment.start_date.strftime('%d %b %Y') }}{% endif %}
                        {% if assignment.end_date %} - {{ assignment.end_date.strftime('%d %b %Y') }}{% endif %}
                    </div>
                </c-card>
            </div>
            {% else %}
            <div class="rvo-text rvo-text--subtle">Geen vacature opdrachten</div>
            {% endfor %}
        </div>
    </div>

    <!-- INGEVULD opdrachten -->
    <div class="wies-kanban-column" data-column="INGEVULD">
        <div class="wies-kanban-column-header">
            <div class="wies-kanban-column-title">
                <span class="utrecht-icon rvo-icon rvo-icon-vinkje rvo-icon--lg" role="img" aria-label="ingevuld-icon"></span>
                <span>Ingevuld</span>
            </div>
            <span class="rvo-badge">{{ assignments_by_status.INGEVULD|length }}</span>
        </div>
        <div class="wies-kanban-cards" id="ingevuld-cards">
            {% for assignment in assignments_by_status.INGEVULD %}
            <div class="wies-kanban-card" draggable="true" data-type="assignment" data-id="{{ assignment.id }}" onclick="openAssignment({{ assignment.id }})">
                <c-card title="{{ assignment.name }}">
                    <div class="wies-card-subtitle">{{ assignment.ministry.name }}</div>
                    <div class="wies-card-meta">
                        {% if assignment.owner %}Eigenaar: {{ assignment.owner.name }}<br>{% endif %}
                        {% if assignment.start_date %}{{ assignment.start_date.strftime('%d %b %Y') }}{% endif %}
                        {% if assignment.end_date %} - {{ assignment.end_date.strftime('%d %b %Y') }}{% endif %}
                    </div>
                </c-card>
            </div>
            {% else %}
            <div class="rvo-text rvo-text--subtle">Geen ingevulde opdrachten</div>
            {% endfor %}
        </div>
    </div>

    <!-- AFGEWEZEN opdrachten -->
    <div class="wies-kanban-column" data-column="AFGEWEZEN">
        <div class="wies-kanban-column-header">
            <div class="wies-kanban-column-title">
                <span class="utrecht-icon rvo-icon rvo-icon-kruis rvo-icon--lg" role="img" aria-label="afgewezen-icon"></span>
                <span>Afgewezen</span>
            </div>
            <span class="rvo-badge">{{ assignments_by_status.AFGEWEZEN|length }}</span>
        </div>
        <div class="wies-kanban-cards" id="afgewezen-cards">
            {% for assignment in assignments_by_status.AFGEWEZEN %}
            <div class="wies-kanban-card" draggable="true" data-type="assignment" data-id="{{ assignment.id }}" onclick="openAssignment({{ assignment.id }})">
                <c-card title="{{ assignment.name }}">
                    <div class="wies-card-subtitle">{{ assignment.ministry.name }}</div>
                    <div class="wies-card-meta">
                        {% if assignment.owner %}Eigenaar: {{ assignment.owner.name }}<br>{% endif %}
                        {% if assignment.start_date %}{{ assignment.start_date.strftime('%d %b %Y') }}{% endif %}
                        {% if assignment.end_date %} - {{ assignment.end_date.strftime('%d %b %Y') }}{% endif %}
                    </div>
                </c-card>
            </div>
            {% else %}
            <div class="rvo-text rvo-text--subtle">Geen afgewezen opdrachten</div>
            {% endfor %}
        </div>
    </div>

</div>

