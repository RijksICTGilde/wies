{# HTMX partial: Updates the main content area when filters change #}
<div id="filter-and-table-container">
  <!-- Page Header -->
  <div class="layout__main__header">
    <!-- Row 1: Title + Search -->
    <div class="header-row header-row--between">
      <c-h1 noMargins>Wie zit waar?</c-h1>
      <div class="header-actions">
        <!-- Mobile filter toggle -->
        <button type="button"
                class="utrecht-button utrecht-button--secondary-action utrecht-button--rvo-md utrecht-button--icon-before rvo-button mobile-filter-toggle"
                onclick="toggleFilters()">
          <span class="utrecht-icon rvo-icon rvo-icon-trechter rvo-icon--md rvo-link__icon--before"
                role="img"
                aria-label=""></span>
          Filters
        </button>
        <!-- Search Field -->
        <form class="rvo-form filter-search-form"
              hx-get="{{ url('home') }}"
              hx-target="#filter-and-table-container"
              hx-push-url="true"
              hx-trigger="change,input delay:500ms from:[data-filter-input]"
              hx-include="[data-filter-input]">
          <div class="search-field-wrapper">
            <c-icon icon="zoek" color="logoblauw" size="md" class="search-icon" />
            <c-input id="search" name="zoek" placeholder="Zoeken..." value="{%- if search_filter -%}{{ search_filter }}{%- endif -%}" aria-label="Zoeken" data-filter-input size />
          </div>
        </form>
      </div>
    </div>
    <!-- Row 2: Result count + Active Filter Chips -->
    <div class="header-row">
      <p class="results-count">
        <b>{{ page_obj.paginator.count }}</b> resultaten
      </p>
      <!-- Active Filter Chips -->
      {% include "parts/filter_chips.html" %}
    </div>
  </div>
  <!-- Placement Table -->
  <div class="rvo-table--responsive placement-table" id="placement_table">
    <table class="rvo-table">
      <thead class="rvo-table-head">
        <tr class="rvo-table-row">
          {% with field="name", label="Naam", target="#filter-and-table-container", sort_state=get_sort_state(request, "name") %}
            {% include "parts/generic_sortable_header.html" %}
          {% endwith %}
          {% with field="assignment", label="Opdracht", target="#filter-and-table-container", sort_state=get_sort_state(request, "assignment") %}
            {% include "parts/generic_sortable_header.html" %}
          {% endwith %}
          {% with field="skill", label="Rol", target="#filter-and-table-container", sort_state=get_sort_state(request, "skill") %}
            {% include "parts/generic_sortable_header.html" %}
          {% endwith %}
          <th class="rvo-table-header">Periode</th>
        </tr>
      </thead>
      <tbody>
        {% include "parts/placement_table_rows.html" %}
      </tbody>
    </table>
  </div>
</div>
