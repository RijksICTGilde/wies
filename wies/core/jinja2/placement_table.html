{% extends 'base.html' %}

{% block extra_head %}
<link rel="stylesheet" href="{{ static('css/placements.css') }}">
<link rel="stylesheet" href="{{ static('css/side_panel.css') }}">
{% endblock %}

{% block content %}
<div id="placement_content" class="rvo-layout-column rvo-layout-gap--md">

  <c-h1>Wie zit waar?</c-h1>

  {% with url_name='placements', target_selector='#placement_table' %}
    {% include 'parts/generic_filter_bar.html' %}
  {% endwith %}

  <!-- Content -->
  <div id="placement_table" class="rvo-table-container">
    {% include 'parts/placement_table.html' %}
  </div>

</div>

<!-- Side Panel Container -->
<div id="side_panel-container">
  {% if panel_data %}
    {% set colleague = panel_data.colleague %}
    {% set assignment = panel_data.assignment %}
    {% include 'parts/side_panel.html' %}

    <script>
      // ESC key handler - click the close button
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          console.log('Escape key pressed - closing side panel');
          const closeBtn = document.querySelector('#side_panel .rvo-dialog__close a');
          if (closeBtn) {
            closeBtn.click();
          }
        }
      });
      
      // Click outside panel to close
      document.getElementById('side_panel-overlay').addEventListener('click', function(e) {
        // Only close if clicked on the overlay itself, not on dialog content
        if (e.target === this) {
          const closeBtn = document.querySelector('#side_panel .rvo-dialog__close a');
          if (closeBtn) {
            closeBtn.click();
          }
        }
      });
    </script>
  {% endif %}
</div>

{% endblock %}