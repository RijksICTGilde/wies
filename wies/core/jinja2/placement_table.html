{% extends 'base.html' %}

{% block extra_head %}
<link rel="stylesheet" href="{{ static('css/placements.css') }}">
<link rel="stylesheet" href="{{ static('css/panel.css') }}">
{% endblock %}

{% block content %}
<div class="rvo-layout-column rvo-layout-gap--md">

  <c-h1>Wie zit waar?</c-h1>

  {% with url_name='placements', target_selector='#placement_table' %}
    {% include 'parts/generic_filter_bar.html' %}
  {% endwith %}

  <!-- Content -->
  <div id="placement_table" class="rvo-table-container">
    {% include 'parts/placement_table.html' %}
  </div>

</div>

<!-- Side Panel Container -->
<div id="sidepanel-container" 
     hx-on:htmx:afterSwap="if(document.getElementById('sidepanel')) { document.body.classList.add('panel-open') } else { document.body.classList.remove('panel-open') }">
  {% if panel_data %}
    {% set panel_content_template = panel_data.panel_content_template %}
    {% set panel_title = panel_data.panel_title %}
    {% set breadcrumb_items = panel_data.breadcrumb_items %}
    {% set close_url = panel_data.close_url %}
    {% set placement = panel_data.placement %}
    {% set colleague = panel_data.colleague %}
    {% set assignment_list = panel_data.assignment_list %}
    {% set assignment = panel_data.assignment %}
    {% set placements = panel_data.placements %}
    {% include 'parts/sidepanel.html' %}
    <script>
      document.body.classList.add('panel-open');
      // ESC key handler - navigate to close URL (server-side)
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          window.location.href = '{{ close_url|safe }}';
        }
      });
    </script>
  {% endif %}
</div>

{% endblock %}